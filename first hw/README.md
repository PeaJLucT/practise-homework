# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ —É—Ä–æ–∫—É 1: –û—Å–Ω–æ–≤—ã PyTorch

## –ó–∞–¥–∞–Ω–∏–µ 1

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `homework_tensors.py` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:

### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–æ–≤
```python
# –°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ç–µ–Ω–∑–æ—Ä—ã:
# - –¢–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 3x4, –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –æ—Ç 0 –¥–æ 1
torch.rand(3,4)
# - –¢–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 2x3x4, –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –Ω—É–ª—è–º–∏
torch.zeros(2,3,4)
# - –¢–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 5x5, –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –µ–¥–∏–Ω–∏—Ü–∞–º–∏
torch.ones(5,5)
# - –¢–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 4x4 —Å —á–∏—Å–ª–∞–º–∏ –æ—Ç 0 –¥–æ 15 (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ reshape)
torch.arange(0,16)
torch.reshape(4,4)
```

### 1.2 –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–Ω–∑–æ—Ä–∞–º–∏
```python
# –î–∞–Ω–æ: —Ç–µ–Ω–∑–æ—Ä A —Ä–∞–∑–º–µ—Ä–æ–º 3x4 –∏ —Ç–µ–Ω–∑–æ—Ä B —Ä–∞–∑–º–µ—Ä–æ–º 4x3
A = torch.tensor([[1,1,1,1],[2,2,2,2],[3,3,3,3]])
B = torch.arange(1,13)
B = B.reshape(4,3)
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
# - –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–Ω–∑–æ—Ä–∞ A
A.transpose(1,0)
# - –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ A –∏ B
C = A @ B
# - –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ A –∏ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ B
B.transpose_(0,1)
C = A * B
# - –í—ã—á–∏—Å–ª–∏—Ç–µ —Å—É–º–º—É –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ç–µ–Ω–∑–æ—Ä–∞ A
A_sum = A.sum()
```

### 1.3 –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ —Å—Ä–µ–∑—ã
```python
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 5x5x5
example = torch.arange(0,125).reshape(5,5,5)
print(f'A = {example}')
# –ò–∑–≤–ª–µ–∫–∏—Ç–µ:
# - –ü–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É
print(f'A[0]: \n{example[0]}')
# - –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü
print(f'A[-1]: \n{example[-1]}')
# - –ü–æ–¥–º–∞—Ç—Ä–∏—Ü—É —Ä–∞–∑–º–µ—Ä–æ–º 2x2 –∏–∑ —Ü–µ–Ω—Ç—Ä–∞ —Ç–µ–Ω–∑–æ—Ä–∞
print(f'–ü–æ–¥–º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–æ–º 2x2 –∏–∑ —Ü–µ–Ω—Ç—Ä–∞ —Ç–µ–Ω–∑–æ—Ä–∞: \n{example[2,2:4,2:4]')
# - –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —á–µ—Ç–Ω—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏
print(f'–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —á–µ—Ç–Ω—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏: \n{example[:,:,::2]}')
```

### 1.4 –†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–º–∏
```python
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 24 —ç–ª–µ–º–µ–Ω—Ç–∞
example = torch.arange(1,25)
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –µ–≥–æ –≤ —Ñ–æ—Ä–º—ã:
# - 2x12
example = example.reshape(2,12)
# - 3x8
example = example.reshape(3,8)
# - 4x6
example = example.reshape(4,6)
# - 2x3x4
example = example.reshape(2,3,4)
# - 2x2x2x3
example = example.reshape(2,2,2,3)
```

## –ó–∞–¥–∞–Ω–∏–µ 2

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `homework_autograd.py`:

### 2.1 –ü—Ä–æ—Å—Ç—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
```python
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ–Ω–∑–æ—Ä—ã x, y, z —Å requires_grad=True
x = torch.tensor([1.0,2.0,3.0,4.0],requires_grad=True)
y = torch.tensor([5.0,6.0,7.0,8.0],requires_grad=True)
z = torch.tensor([9.0,10.0,11.0,12.0],requires_grad=True)

# –í—ã—á–∏—Å–ª–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é: f(x,y,z) = x^2 + y^2 + z^2 + 2*x*y*z
f_x_y_z = x**2 + y**2 + z**2 + 2*x*y*z
f = f_x_y_z.sum()

# –ù–∞–π–¥–∏—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø–æ –≤—Å–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
f.backward()
x.grad
y.grad
z.grad

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏
–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç –∫–∞–∫–æ–≥–æ –ª–∏–±–æ —Ç–µ–Ω–∑–æ—Ä–∞, –Ω–∞–¥–π–µ–º –µ–≥–æ —á–∞—Å—Ç–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
‚àÇf / ‚àÇx = 2*x + 2*y*z
‚àÇf / ‚àÇy = 2*y + 2*x*z
‚àÇf / ‚àÇz = 2*z + 2*x*y
–¢–æ–≥–¥–∞ –¥–ª—è —Ç–µ–Ω–∑–æ—Ä–∞ X:
i=0: 2*1.0 + 2*5.0*9.0 = 2 + 90 = 92.0
i=1: 2*2.0 + 2*6.0*10.0 = 4 + 120 = 124.0
i=2: 2*3.0 + 2*7.0*11.0 = 6 + 154 = 160.0
i=3: 2*4.0 + 2*8.0*12.0 = 8 + 192 = 200.0
–ò –ø–æ–ª—É—á–∏—Ç—Å—è x.grad = [ 92, 124, 160, 200], –∫–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ –≤—ã—à–µ
```

### 2.2 –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å
```python
# –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é MSE (Mean Squared Error):
# MSE = (1/n) * Œ£(y_pred - y_true)^2
# –≥–¥–µ y_pred = w * x + b (–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
def mse(y_pred, y_true):
    """
    Mean Squared Error

    y_true: —Ç–µ–Ω–∑–æ—Ä —Å –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    y_pred: —Ç–µ–Ω–∑–æ—Ä —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    """
    sqr_error = (y_pred - y_true)**2
    MSE = torch.mean(sqr_error)
    return MSE

# –ù–∞–π–¥–∏—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø–æ w –∏ b
w = torch.tensor(2.0, requires_grad=True) 
b = torch.tensor(1.0, requires_grad=True)
x = torch.tensor([1.0, 2.0, 3.0])
y_true = torch.tensor([3.5, 5.0, 7.5])
y_pred = w * x + b

loss = mse(y_pred, y_true)
print(f'mse = {loss}')

loss.backward()
print(f'w.grad = {w.grad}')
print(f'b.grad = {b.grad}')
```

### 2.3 –¶–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ
```python
# –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–æ—Å—Ç–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é: f(x) = sin(x^2 + 1)
def func(x):
    sqr = x**2 + 1
    answer = torch.sin(sqr)
    return answer

x = torch.tensor([3.0, 10.0, 0.0], requires_grad=True)
answer = func(x)
print(f'func(x) = {answer}')

# –ù–∞–π–¥–∏—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç df/dx
answer = answer.sum()
answer.backward()
x_gr = x.grad   
print(f'x.grad = {x_gr}')

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –ø–æ–º–æ—â—å—é torch.autograd.grad
check_x_gr = torch.autograd.grad(answer, x)
print(f'autograd.grad(x) = {check_x[0]}')
# –í –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è 
[-5.0344, 17.8401,  0.0000]
–∏ –≤–æ –≤—Ç–æ—Ä–æ–º
[-5.0344, 17.8401,  0.0000], –ø–æ—ç—Ç–æ–º—É –Ω–∞–π–¥–µ–Ω –≥—Ä–∞–¥–∏–µ–Ω—Ç –≤–µ—Ä–Ω–æ
```

## –ó–∞–¥–∞–Ω–∏–µ 3
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `homework_performance.py`:

### 3.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```python
# –°–æ–∑–¥–∞–π—Ç–µ –±–æ–ª—å—à–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞–∑–º–µ—Ä–æ–≤:
# - 64 x 1024 x 1024
A = torch.randint(1,100,[64,1024,1024])
print(f'A.size - {A.shape}')
# print(f'{A[:10,:10,:10]}')

# - 128 x 512 x 512
B = torch.randint(1,100,[128,512,512])
print(f'B.size - {B.shape}')

# - 256 x 256 x 256
C = torch.randint(1,100,[256,256,256])
print(f'C.size - {C.shape}')
# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏—Ö —Å–ª—É—á–∞–π–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏
```

### 3.2 –§—É–Ω–∫—Ü–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
```python
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ torch.cuda.Event() –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –Ω–∞ GPU
def time_GPU(func, *args):
    if torch.cuda.is_available():
        start_event = torch.cuda.Event(enable_timing=True)
        end_event = torch.cuda.Event(enable_timing=True)
        torch.cuda.synchronize() #–û–∂–∏–¥–∞–µ–º —á—Ç–æ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ–∫–æ–Ω—á–µ–Ω—ã –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ–¥—Å—á–µ—Ç–æ–≤
        
        start_event.record()
        func(*args)
        end_event.record()
        torch.cuda.synchronize() #–û–∂–∏–¥–∞–µ–º –ø–æ–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –Ω–∞—à –ø—Ä–æ—Ü–µ—Å—Å

        time_ms = start_event.elapsed_time(end_event)
        return time_ms / 1000.0
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ time.time() –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –Ω–∞ CPU
def time_CPU(func, *args):
    start = time.time()
    func(*args)
    end = time.time()
    return end - start
```

### 3.3 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
```python
# –°—Ä–∞–≤–Ω–∏—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ CPU –∏ CUDA:
A = torch.randint(1,100, [8,1024, 1024],dtype=torch.float16) # float16 –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ø–∞–º—è—Ç–∏
B = torch.randint(1,100, [8,1024, 1024],dtype=torch.float16)
print(f'sizeA - {A.shape}; sizeB - {B.shape}')
gpu_times = []
cpu_times = []
if torch.cuda.is_available():
    print('GPU –≤ –Ω–æ—Ä–º–µ, –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø')
    A_gpu = A.to('cuda')
    B_gpu = B.to('cuda') 

    # - –ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ (torch.matmul)
    gpu_matmul = time_GPU(torch.matmul, A_gpu, B_gpu)
    gpu_times.append(gpu_matmul)
    cpu_matmul = time_CPU(torch.matmul, A, B)
    cpu_times.append(cpu_matmul)
    print(f'1_gpu - {gpu_matmul}; 1_cpu - {cpu_matmul}')

    # - –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ
    gpu_add = time_GPU(torch.add, A_gpu, B_gpu)
    gpu_times.append(gpu_add)
    cpu_add = time_CPU(torch.add, A, B)
    cpu_times.append(cpu_add)
    print(f'2_gpu - {gpu_add}; 2_cpu - {cpu_add}')  

    # - –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ
    gpu_mul = time_GPU(torch.multiply, A_gpu, B_gpu)
    gpu_times.append(gpu_mul)
    cpu_mul = time_CPU(torch.mul, A, B)
    cpu_times.append(cpu_mul)
    print(f'3_gpu - {gpu_mul}; 3_cpu - {cpu_mul}')

    # - –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
    gpu_tran_1 = time_GPU(torch.transpose, A_gpu, 0, 1)
    gpu_tran_2 = time_GPU(torch.transpose, B_gpu, 0, 1)
    gpu_tran = (gpu_tran_1 + gpu_tran_2) # –¢–∫ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–æ–∂–Ω–æ 
    # –ø–æ –æ–¥–∏–Ω–æ—á–∫–µ, —Ç–æ –º—ã —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—Ä–µ–º—è —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è 1 –º–∞—Ç—Ä–∏—Ü—ã –∏ –≤—Ç–æ—Ä–æ–π –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
    gpu_times.append(gpu_tran)
    cpu_tran1 = time_CPU(torch.transpose, A, 0, 1)
    cpu_tran2 = time_CPU(torch.transpose, B, 0, 1)
    cpu_tran = cpu_tran1 + cpu_tran2
    cpu_times.append(cpu_tran)
    print(f'4_gpu - {gpu_tran}; 4_cpu - {cpu_tran}')

    # - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    gpu_sum1 = time_GPU(torch.sum, B_gpu)
    gpu_sum2 = time_GPU(torch.sum, A_gpu)
    gpu_sum = gpu_sum1 + gpu_sum2
    gpu_times.append(gpu_sum)
    cpu_sum1 = time_CPU(torch.sum, A)
    cpu_sum2 = time_CPU(torch.sum, B)
    cpu_sum = cpu_sum1 + cpu_sum2
    cpu_times.append(cpu_sum)
    print(f'5_gpu - {gpu_sum}; 5_cpu - {cpu_sum}')


print(f'–û–ø–µ—Ä–∞—Ü–∏—è                       | CPU(–º—Å) | GPU(–º—Å) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ') 
operations = ['–ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ',
              '–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ',
              '–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ',
              '–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ',
              '–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤']

for i in range(len(operations)):
    cpu_t = cpu_times[i]
    gpu_t = gpu_times[i]
    op_name = operations[i]
    acceleration = cpu_t / gpu_t
    print(f"{op_name:<30} | {cpu_t:>7.3f} | {gpu_t:>7.3f} | {acceleration:>6.1f}x")

# –£ –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–æ—Å—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
1_gpu - 0.10270953369140624; 1_cpu - 16.84285283088684
2_gpu - 0.030246912002563478; 2_cpu - 0.0020024776458740234
3_gpu - 0.00891596794128418; 3_cpu - 0.0030014514923095703
4_gpu - 0.00037376000732183454; 4_cpu - 0.0
5_gpu - 0.09682738971710204; 5_cpu - 0.0020079612731933594
–û–ø–µ—Ä–∞—Ü–∏—è                       | CPU(–º—Å) | GPU(–º—Å) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ
–ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ            |  16.843 |   0.103 |  164.0x
–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ          |   0.002 |   0.030 |    0.1x
–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ         |   0.003 |   0.009 |    0.3x
–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ               |   0.000 |   0.000 |    0.0x
–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ |   0.002 |   0.097 |    0.0x



1_gpu - 0.10707100677490235; 1_cpu - 8.304519891738892
2_gpu - 0.02082713508605957; 2_cpu - 0.0020055770874023438
3_gpu - 0.006554624080657959; 3_cpu - 0.0011508464813232422
4_gpu - 9.216000000014901e-05; 4_cpu - 0.0
5_gpu - 0.01033318442106247; 5_cpu - 0.0010035037994384766
–û–ø–µ—Ä–∞—Ü–∏—è                       | CPU(–º—Å) | GPU(–º—Å) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ
–ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ            |   8.305 |   0.107 |   77.6x
–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ          |   0.002 |   0.021 |    0.1x
–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ         |   0.001 |   0.007 |    0.2x
–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ               |   0.000 |   0.000 |    0.0x
–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—É–º–º—ã –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ |   0.001 |   0.010 |    0.1x
```

### 3.4 –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
# –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
# - –ö–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –Ω–∞ GPU?
–í –∫–æ—Ç–æ—Ä—ã—Ö –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π/–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
# - –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –Ω–∞ GPU?
–ü–æ—Ç–æ–º—É —á—Ç–æ GPU —Ç—Ä–∞—Ç–∏—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏/–ø–∞–º—è—Ç–∏/—Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è —Å–≤–æ–µ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, —Ç–æ –µ—Å—Ç—å –≤—Ä–µ–º—è –±–æ–ª—å—à–µ –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –∏–º–µ–Ω–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—é –∞ –Ω–µ —Å–∞–º–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
# - –ö–∞–∫ —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü –≤–ª–∏—è–µ—Ç –Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ?
–ß–µ–º –±–æ–ª—å—à–µ –º–∞—Ç—Ä–∏—Ü–∞ —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ GPU —Ç–∫ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ, –∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–µ–µ, –ø–æ—ç—Ç–æ–º—É –∏—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–µ –ª–∏–Ω–µ–π–Ω–æ –∞ —Å–∫–æ—Ä–µ–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏
# - –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É CPU –∏ GPU?
–î–∞–Ω–Ω—ã–µ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ RAM –≤ VRAM –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–∞–±–æ—Ç—ã
```   

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Ç–∞–µ–º—ã–º** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –¥–æ–±–∞–≤—å—Ç–µ docstring –∫ —Ñ—É–Ω–∫—Ü–∏—è–º
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã
5. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Å GPU, —Ç–∞–∫ –∏ –±–µ–∑ –Ω–µ–≥–æ

## –°—Ä–æ–∫ —Å–¥–∞—á–∏
–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–æ –Ω–∞—á–∞–ª–∞ –∑–∞–Ω—è—Ç–∏—è 3.

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- [PyTorch Documentation](https://pytorch.org/docs/stable/index.html)
- [PyTorch Tutorials](https://pytorch.org/tutorials/)
- [Autograd Mechanics](https://pytorch.org/docs/stable/notes/autograd.html)
- [CUDA Performance](https://pytorch.org/docs/stable/notes/cuda.html)

–£–¥–∞—á–∏ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è! üöÄ 